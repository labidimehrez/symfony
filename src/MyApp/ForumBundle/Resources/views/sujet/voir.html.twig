{# empty Twig template #}
{{ render(controller('MyAppEspritBundle:publicite:showextpub')) }}
 {{ render(controller('MyAppEspritBundle:notification:shownumber')) }} {# pour afficher notif number #}


 {% include 'TwitterBootstrapBundle::stylesheets.html.twig'%}
 {% include 'MyAppEspritBundle:Default:sousmenu.html.twig'  with { 'routeName':app.request.get('_route') }%}

<script src="{{ asset('bundles/myappesprit/js/jquery-1.10.1.min.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/myappesprit/js/jquery-1.4.2.min.js') }}" type="text/javascript"></script>

<div class="contenudetemplate">
    <div class="paddingdebataveccomment">

        </br> 

{% if sujet.user is not null %}
{% if sujet.user.image is not null  %}
        <img src="{{sujet.user.image }}"  
             class="imageuserdebataveccomment" alt="" />  
{% else %}
        <img src="{{ asset('bundles/myappesprit/images/user.png') }}"  
             class="imageuserdebataveccomment" alt=""  />             
{% endif%}

        &nbsp;&nbsp;&nbsp;
        <b style="color: black" >{{sujet.user.username|capitalize}}</b>
        <b class="timestyle">{{ time_diff(sujet.datecreation) }}{#{sujet.datecreation|date('') |ago}#} </b>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <img src="{{ asset('bundles/myappesprit/images/commentCount.png') }}" height="20px;" width="20px;" alt=""/> &nbsp;<b>{{commentCount}}</b>
        </br> 

{% else%}

        <img src="{{ asset('bundles/myappesprit/images/user.png') }}"  
             class="imageuserdebataveccomment"alt="" />  
        &nbsp;&nbsp;&nbsp;
        <b style="color: black">Anonymous</b>
        <b class="timestyle">{{ time_diff(sujet.datecreation) }}{#{sujet.datecreation|date('') |ago}#} </b>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <img src="{{ asset('bundles/myappesprit/images/commentCount.png') }}" height="20px;" width="20px;" alt=""/> &nbsp;<b>{{commentCount}}</b>

 {% endif%}       

        <b style="color: black;  padding-left: 130px;"> <FONT size="5px;"> {{sujet.sujet}}</FONT></b>
        <div class="contenutopic">





            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</br>
         {{sujet.contenu|Contenu}}   </br>  
            <a class="flip">Add new comment</a>

            <div  class="tagtitlevoirun">
                {% set counternombredetag = 0 %} 
                {% for tag in tag %}      
                <b> {% set counternombredetag = counternombredetag + 1 %}{{tag.title}} &nbsp;{% if not  loop.last %},{%endif%}&nbsp;</b>


                {% endfor%} 
              {#%if sujet.user ==  app.user.username and app.user.username is defined %#}

                <a id=show>  
               {% if counternombredetag > 0%}
                    <img src="{{ asset('bundles/myappesprit/images/admin/icn_edit.png') }}" alt="" />
                 {% endif%}
                </a> 

                <div class="tagdivedit" style="  position: absolute;background-color: white;  top: 30px;  left: 500px;">
                    <form role="form" method="post" {{ form_enctype(form) }}  action='{{path('my_app_forum_sujet_voir',{'id':sujet.id})}}'>
                        <input type="text" name="i[]" id="" 
                        value="{% for tag in tag %}{{tag.title}}&nbsp;{% if not  loop.last %},{%endif%}{% endfor%}">                    
                        <input type="submit"   value="Gem" class="btn btn-warning btn-lg">   &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
                        <input type="reset" id=hide value="Annuler" style="background-color: transparent;border: 0px; color:#c52821;"> 
                    </form>
                </div>
            </div>
        </div>




                    {# debut affichage des commentaires #}


        <div class="commentaire">
              {% for  commentaire in commentaire %}{% if loop.index <= sujet.thread %}
                {% set commentaireid = commentaire.id %} 
            <div class="contenucommentaireparent"> 

            {% if commentaire.user.image is not null  %} <img src="{{commentaire.user.image }}" class="imageuser" alt=""/> {% else %}  
                <img src="{{ asset('bundles/myappesprit/images/user.png') }}"  class="imageuser" alt=""   />{% endif%} 


                <b>{{commentaire.user.username|capitalize}}</b><b class="timestyle">{{ time_diff(commentaire.datecreation) }}</b>



            {% if commentaire.vote  is not null %}
                <b class="likecount"><img src="{{ asset('bundles/myappesprit/images/like.png') }}" height="20px;" width="20px;" alt=""/>
                    &nbsp;{{commentaire.vote}} </b>
             {%endif%}       
                </br>   {{commentaire.texte}}  </br> 




                <a id=showthread{{commentaireid}}><img src="{{ asset('bundles/myappesprit/images/flechedroite.png') }}" height="20px;" width="20px;" alt=""/></a> 
                <a id=hidethread{{commentaireid}}><img src="{{ asset('bundles/myappesprit/images/flechebas.png') }}" height="20px;" width="20px;" alt=""/></a>

                <script type="text/javascript">
                    $("#showthread{{commentaireid}}").click(function() {
                        $("div#div{{commentaireid}}").show(1000);
                        $("a#showthread{{commentaireid}}").hide();
                        $("a#hidethread{{commentaireid}}").show();
                    });

                    $("#hidethread{{commentaireid}}").click(function() {
                        $("div#div{{commentaireid}}").hide(10);
                        $("a#hidethread{{commentaireid}}").hide();
                        $("a#showthread{{commentaireid}}").show();
                    });
                </script>

                <a class="flip2">Add new comment &nbsp; {{commentaire.id}}</a>
                <b class="likebutton">like</b>
                  {%if  ("EDITOR" in app.user.roles|join) or ( commentaire.user ==  app.user.username ) %}
                <a class="flipedit" style="text-decoration:none;" ><b class="likebutton" >Edit</b></a> 
                 {%endif%}
                &nbsp;&nbsp;&nbsp;&nbsp; 
                  {%if  ("EDITOR" in app.user.roles|join) or ( commentaire.user ==  app.user.username ) %}
                <a href="{{ path('my_app_forum_commentaire_delete',{'id':commentaire.id}) }}"style="text-decoration:none;" class="deletecommentaire">Delete</a> 
                {%endif%}
                </br> 
            </div>


              {% for  souscommentaire in souscommentaire %}{% if souscommentaire.commentaire.id == commentaire.id %}
            <div class="contenucommentairefils" id="div{{commentaireid}}"> 

              {% if souscommentaire.user.image is not null  %} <img src="{{souscommentaire.user.image }}" class="imageuser" alt=""/> {% else %}  
                <img src="{{ asset('bundles/myappesprit/images/user.png') }}"  class="imageuser" alt=""   />{% endif%} 


                <b>{{souscommentaire.user.username|capitalize}}</b><b class="timestyle">{{ time_diff(souscommentaire.datecreation) }}</b>


            {% if souscommentaire.vote  is not null %}
                <b class="likecount"><img src="{{ asset('bundles/myappesprit/images/like.png') }}" height="20px;" width="20px;" alt=""/>
                    &nbsp;{{souscommentaire.vote}} </b>
             {%endif%}                   
                </br>
                    {{souscommentaire.texte}}
                </br> 
                <a class="flip2">Add new comment &nbsp; {{souscommentaire.id}}</a> 
                <b class="likebutton">like</b>
                {%if  ("EDITOR" in app.user.roles|join) or ( souscommentaire.user ==  app.user.username ) %} 
                <a class="flipedit2"  style="text-decoration:none;"><b class="likebutton">Edit</b></a> 
                {%endif%}
                &nbsp;&nbsp;&nbsp;&nbsp;   

                {%if  ("EDITOR" in app.user.roles|join) or ( souscommentaire.user ==  app.user.username ) %} 
                <a href="{{ path('my_app_forum_commentaire_delete',{'id':souscommentaire.id}) }}"style="text-decoration:none;" class="deletecommentaire">Delete</a> 
                 {%endif%}
                <div class="panel2">
                {% if is_granted( 'ROLE_USER' ) %}{{ render(controller('MyAppForumBundle:commentaire:addsouscomment')) }}{%endif%} </div>
                </br> 
            </div>
            {%endif%} {% endfor%}



          {%endif%}{% endfor%}
        </div>
                    {# fin affichage des commentaires #}
        {% if is_granted( 'ROLE_USER' ) %}
        <script src="{{ asset('bundles/myappesprit/js/siconnecte.js') }}" type="text/javascript"></script> 


        <div class="panel"> 
            <div   class="nouveaucommentaire"   >
          {% if app.user.image is not null %} 
                <img src="{{ app.user.image }}" class="imageuser" alt=""/>
          {%else%}
                <img src="{{ asset('bundles/myappesprit/images/user.png') }}"  class="imageuser" alt=""   />
          {%endif%}   
                <b>Comment &nbsp; <b  class="rouge">*</b> &nbsp;&nbsp;</br></br>
          {{ render(controller('MyAppForumBundle:commentaire:add')) }}  
            </div>
        </div> 


        {#####################################################}
        <div class="paneledit"> 
            <div   class="nouveaucommentaire"   >
          {% if app.user.image is not null %} 
                <img src="{{ app.user.image }}" class="imageuser" alt=""/>
          {%else%}
                <img src="{{ asset('bundles/myappesprit/images/user.png') }}"  class="imageuser" alt=""   />
          {%endif%}   
                <b>Comment &nbsp; <b  class="rouge">*</b> &nbsp;&nbsp;</br></br>
           {{ render(controller('MyAppForumBundle:commentaire:edit')) }}     
            </div>
        </div> 
        <div class="paneledit2">{{ render(controller('MyAppForumBundle:commentaire:editsouscomment')) }} </div>



        {% else %}

        <script src="{{ asset('bundles/myappesprit/js/sinonconnecte.js') }}" type="text/javascript"></script> 

        <div class="panel3" id="cacherdiv"> 
            <p>Kun brugere, der er logged ind kan tilfoje</br> kommentarer.Du kan vaelge at logge pa eller oprettte</br> en ny profile </p></br>
            <a href="{{ path('fos_user_security_login') }}" class="btn btn-warning btn-lg">Log ind</a>  
            <a href="{{ path('fos_user_registration_register') }}" style="text-decoration:none;color:#c52821;">                                                                                                                                                      
                &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;Opre profil&nbsp;&nbsp;</a>   
            <a class="flip3"> &nbsp;&nbsp; &nbsp;&nbsp; &nbsp;&nbsp;Annuler&nbsp;&nbsp;</a> 


        </div>
        {% endif %}

        <br>





    </div> 
</div>



<style type="text/css">
    a.flip {
        text-decoration:none;
        color: #c52821;
        font-weight: bold;
        height: 50px;
        width: 200px;
        padding-left: 15px;
        padding-top: 10px;
        background-color: transparent;
        /* border-color: aqua;
         border-style: dashed;*/
    }
    a.flip2 {

        color: #c52821;
        font-weight: bold;
        text-decoration:none;
    }
    a.flip3 {

        color: #c52821;
        font-weight: bold;
        text-decoration:none;
    }



    div.panel {display: none;}
    div.panel2 {display: none;  padding-left: 100px;padding-top: 10px;} 
    div.panel3 {
        padding: 10px;
        padding-left: 50px;
        width: 450px;
        display: none;
        -moz-box-shadow: 10px 10px 5px 0px #656565;
        -webkit-box-shadow: 10px 10px 5px 0px #656565;
        -o-box-shadow: 10px 10px 5px 0px #656565;
        box-shadow: 10px 10px 5px 0px #656565;
        filter:progid:DXImageTransform.Microsoft.Shadow(color=#656565, Direction=134, Strength=5);
        border: 1px black;border-style: solid;
    }
    div.paneledit {display: none;}
    div.paneledit2 {display: none;  padding-left: 100px;padding-top: 10px;} 
    div.tagdivedit {
        padding: 10px;
        padding-left: 50px;
        width: 400px;
        display: none;
        -moz-box-shadow: 10px 10px 5px 0px #656565;
        -webkit-box-shadow: 10px 10px 5px 0px #656565;
        -o-box-shadow: 10px 10px 5px 0px #656565;
        box-shadow: 10px 10px 5px 0px #656565;
        filter: progid:DXImageTransform.Microsoft.Shadow(color=#656565, Direction=134, Strength=5);
        border: 1px black;
        border-style: solid;
        background-color: white;  z-index: 1000000;
    }


</style>








<script type="text/javascript">
                    $("a#show").click(function() {
                        $("div.tagdivedit").slideToggle("slow");
                    });
                    $("input#hide").click(function() {
                        $("div.tagdivedit").hide(1000);
                    });
</script>