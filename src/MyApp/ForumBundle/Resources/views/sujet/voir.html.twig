{# empty Twig template #}
{{ render(controller('MyAppEspritBundle:publicite:showextpub')) }}
{{ render(controller('MyAppEspritBundle:notification:shownumber')) }} {# pour afficher notif number #}


 {% include 'TwitterBootstrapBundle::stylesheets.html.twig'%}
 {% include 'MyAppEspritBundle:Default:sousmenu.html.twig'  with { 'routeName':app.request.get('_route') }%}

<script src="{{ asset('bundles/myappesprit/js/jquery-1.10.1.min.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/myappesprit/js/jquery-1.4.2.min.js') }}" type="text/javascript"></script>

<div class="contenudetemplate">
    <div class="paddingdebataveccomment">

        </br> 
 {% include 'MyAppForumBundle:sujet/fragment:userimage.html.twig'%}        

        <b style="color: black;  padding-left: 130px;"> <FONT size="5px;"> {{sujet.sujet}}</FONT></b>
        <div class="contenutopic">





            &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</br>
         {{sujet.contenu|Contenu}}   </br>  
            <a class="bouttonnouveaucommentaire{{commentaireid}}">Add new comment</a>

                {% include 'MyAppForumBundle:sujet/fragment:divedittag.html.twig'%}  



        </div>




                    {# debut affichage des commentaires #}


        <div class="commentaire">
              {% for  commentaire in commentaire %}{% if loop.index <= sujet.thread %}
                {% set commentaireid = commentaire.id %} 
            <div class="contenucommentaireparent"> 

         {% include 'MyAppForumBundle:sujet/fragment:imagevotecommentaire.html.twig'%}        

                </br>   {{commentaire.texte}}  </br> 




                <a id=showthread{{commentaireid}} class="sho"><img src="{{ asset('bundles/myappesprit/images/flechedroite.png') }}" height="20px;" width="20px;" alt=""/></a> 
                <a id=hidethread{{commentaireid}} class="hid"><img src="{{ asset('bundles/myappesprit/images/flechebas.png') }}" height="20px;" width="20px;" alt=""/></a>
                 {## show hide thread altern√© :D ##}
                <script type="text/javascript">
                    $("#showthread{{commentaireid}}").click(function() {
                        $("div#div{{commentaireid}}").slideToggle();
                        $("a#showthread{{commentaireid}}").hide();
                        $("a#hidethread{{commentaireid}}").show();
                    });

                    $("#hidethread{{commentaireid}}").click(function() {
                        $("div#div{{commentaireid}}").slideToggle();
                        $("a#hidethread{{commentaireid}}").hide();
                        $("a#showthread{{commentaireid}}").show();
                    });
                </script>

                <a class="bouttonsousnouveaucommentaire">Add new comment &nbsp; {{commentaire.id}}</a>
                <b class="likebutton">like</b>
                  {%if  ("EDITOR" in app.user.roles|join) or ( commentaire.user ==  app.user.username ) %}
                <a href="{{ path('my_app_forum_commentaire_edit',{'id':commentaire.id}) }}" class="bouttoneditcommentaire" style="text-decoration:none;"  >
                    <b class="likebutton" >Edit</b>
                </a> 
                 {%endif%}
                &nbsp;&nbsp;&nbsp;&nbsp; 
                  {%if  ("EDITOR" in app.user.roles|join) or ( commentaire.user ==  app.user.username ) %}
                <a href="{{ path('my_app_forum_commentaire_delete',{'id':commentaire.id}) }}"style="text-decoration:none;" class="deletecommentaire">Delete</a> 
                {%endif%}
                </br> 
            </div>


              {% for  souscommentaire in souscommentaire %}{% if souscommentaire.commentaire.id == commentaire.id %}
            <div class="contenucommentairefils" id="div{{commentaireid}}"> 
                
                    {% include 'MyAppForumBundle:sujet/fragment:imagevotesouscommentaire.html.twig'%} 

                </br>
                    {{souscommentaire.texte}}
                </br> 
              {#  <a class="bouttonsousnouveaucommentaire">Add new comment &nbsp; {{souscommentaire.id}}</a>#}
                <b class="likebutton">like</b>
                {%if  ("EDITOR" in app.user.roles|join) or ( souscommentaire.user ==  app.user.username ) %} 
                <a class="bouttoneditsouscommentaire"  style="text-decoration:none;"><b class="likebutton">Edit</b></a> 
                {%endif%}
                &nbsp;&nbsp;&nbsp;&nbsp;   

                {%if  ("EDITOR" in app.user.roles|join) or ( souscommentaire.user ==  app.user.username ) %} 
                <a href="{{ path('my_app_forum_commentaire_delete',{'id':souscommentaire.id}) }}"style="text-decoration:none;" class="deletecommentaire">Delete</a> 
                 {%endif%}
                <div class="inputnouveausouscommentaire">
                {% if is_granted( 'ROLE_USER' ) %}
                            {{ render(controller('MyAppForumBundle:commentaire:addsouscomment', {'id': commentaire.id})) }}
                {%endif%}
                </div>
                </br> 
            </div>
            {%endif%} {% endfor%}



          {%endif%}




                {% endfor%}
        </div>
                    {# fin affichage des commentaires #}
        {% if is_granted( 'ROLE_USER' ) %}
        <script src="{{ asset('bundles/myappesprit/js/siconnecte.js') }}" type="text/javascript"></script> 


        <div class="inputnouveaucommentaire{{commentaire.id}}"> 
            <div   class="nouveaucommentaire"   >
          {% if app.user.image is not null %} 
                <img src="{{ app.user.image }}" class="imageuser" alt=""/>
          {%else%}
                <img src="{{ asset('bundles/myappesprit/images/user.png') }}"  class="imageuser" alt=""   />
          {%endif%}   
                <b>Comment &nbsp; <b  class="rouge">*</b> &nbsp;&nbsp;</br></br>
          {{ render(controller('MyAppForumBundle:commentaire:add')) }}  
            </div>
        </div> 


        {#####################################################}
        <div class="inputeditcommentaire"> 
            <div   class="nouveaucommentaire"   >
          {% if app.user.image is not null %} 
                <img src="{{ app.user.image }}" class="imageuser" alt=""/>
          {%else%}
                <img src="{{ asset('bundles/myappesprit/images/user.png') }}"  class="imageuser" alt=""   />
          {%endif%}   
                <b>Comment &nbsp; <b  class="rouge">*</b> &nbsp;&nbsp;</br></br>
                         {{ render(controller('MyAppForumBundle:commentaire:edit', {'id': commentaire.id})) }}  
            </div>
        </div> 
        <div class="inputeditsouscommentaire">{{ render(controller('MyAppForumBundle:commentaire:editsouscomment')) }} </div>



        {% else %}
        
                {% include 'MyAppForumBundle:sujet/fragment:sinonconnectenotif.html.twig'%}  
          
        {% endif %}

        <br>





    </div> 
</div>



<style type="text/css">
    a.bouttonnouveaucommentaire {
        text-decoration:none;
        color: #c52821;
        font-weight: bold;
        height: 50px;
        width: 200px;
        padding-left: 15px;
        padding-top: 10px;
        background-color: transparent;
        /* border-color: aqua;
         border-style: dashed;*/
    }
    a.bouttonsousnouveaucommentaire {

        color: #c52821;
        font-weight: bold;
        text-decoration:none;
    }
    a.bouttonnouveaucommentaire3 {

        color: #c52821;
        font-weight: bold;
        text-decoration:none;
    }


    div.inputnouveaucommentaire {display: none;}
    div.inputnouveausouscommentaire {display: none;  padding-left: 100px;padding-top: 10px;} 
    div.inputnouveaucommentaire3 {
        padding: 10px;
        padding-left: 50px;
        width: 450px;
        display: none;
        -moz-box-shadow: 10px 10px 5px 0px #656565;
        -webkit-box-shadow: 10px 10px 5px 0px #656565;
        -o-box-shadow: 10px 10px 5px 0px #656565;
        box-shadow: 10px 10px 5px 0px #656565;
        filter:progid:DXImageTransform.Microsoft.Shadow(color=#656565, Direction=134, Strength=5);
        border: 1px black;border-style: solid;
    }
    a.sho{display: none;}
    div.inputeditcommentaire {display: none;}
    div.inputeditsouscommentaire {display: none;  padding-left: 100px;padding-top: 10px;} 
    div.divedittag {
        padding: 10px;
        padding-left: 50px;
        width: 400px;
        display: none;
        -moz-box-shadow: 10px 10px 5px 0px #656565;
        -webkit-box-shadow: 10px 10px 5px 0px #656565;
        -o-box-shadow: 10px 10px 5px 0px #656565;
        box-shadow: 10px 10px 5px 0px #656565;
        filter: progid:DXImageTransform.Microsoft.Shadow(color=#656565, Direction=134, Strength=5);
        border: 1px black;
        border-style: solid;
        background-color: white;  z-index: 1000000;
    }


</style>





<script type="text/javascript">
                    $(document).ready(function() {
                        $(".bouttonnouveaucommentaire").click(function()
                        {
                            $(".inputnouveaucommentaire{{commentaire.id}}").slideToggle("slow");
                        });
                        $(".bouttonsousnouveaucommentaire").click(function()
                        {
                            $(".inputnouveaucommentaire3").slideToggle("slow");
                        });


                        $(".bouttonnouveaucommentaire3").click(function()
                        {
                            $(".inputnouveaucommentaire3").fadeOut();
                            $("div#cacherdiv").hide();
                        });

                    });
</script>
                {## show hide div edit tag ##}
<script type="text/javascript">
    $("a#show").click(function() {
        $("div.divedittag").slideToggle("slow");
    });
    $("input#hide").click(function() {
        $("div.divedittag").slideToggle("slow");
    });
</script>




<script type="text/javascript">
    $(document).ready(function() {
        $(".bouttonnouveaucommentaire").click(function() {
            $(".inputnouveaucommentaire").slideToggle("slow");/* afficher bouttonnouveaucommentaire */
            $(".inputnouveausouscommentaire").hide();           /* cacher inputnouveausouscommentaire */
            $(".inputeditsouscommentaire").hide();       /* cacher input edit SOUS commentaire */
            $(".inputeditcommentaire").hide();       /* cacher input edit commentaire */
        });
        $(".bouttonsousnouveaucommentaire").click(function() {
            $(".inputnouveausouscommentaire").slideToggle("slow");/* afficher bouttonsousnouveaucommentaire */
            $(".inputnouveaucommentaire").hide();             /* cacher input inputnouveaucommentaire */
            $(".inputeditsouscommentaire").hide();       /* cacher inputeditsouscommentaire */
            $(".inputeditcommentaire").hide();       /* cacher input edit commentaire */
        });

        $(".bouttoneditcommentaire").click(function() {
            $(".inputeditcommentaire").slideToggle("slow");/* afficher bouttoneditcommentaire */
            $(".inputnouveaucommentaire").hide();   /* cacher input nouveau  commentaire */
            $(".inputnouveausouscommentaire").hide(); /* cacher input nouveau SOUS commentaire */
            $(".inputeditsouscommentaire").hide();/* cacher input EDIT SOUS nouveau commentaire */
        });

        $(".bouttoneditsouscommentaire").click(function() {
            $(".inputeditsouscommentaire").slideToggle("slow");/* afficher bouttoneditsouscommentaire */
            $(".inputnouveaucommentaire").hide();  /* cacher input nouveau  commentaire */
            $(".inputnouveausouscommentaire").hide();/* cacher input nouveau SOUS commentaire */
            $(".inputeditcommentaire").hide();       /* cacher inputeditcommentaire */
        });

    });
</script>